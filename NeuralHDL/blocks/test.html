<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Basic Test Example | NeuralHDL</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-mermaid-2/bower_components/mermaid/dist/mermaid.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-katex/katex.min.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../blocks/Neuron.html" />
    
    
    <link rel="prev" href="../blocks/simple.html" />
    

        <script src="../gitbook/plugins/gitbook-plugin-mermaid-2/bower_components/mermaid/dist/mermaid.min.js"></script><link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-mermaid-2/bower_components/mermaid/dist/mermaid.forest.css"></link>
    </head>
    <body>
        
        
    <div class="book" data-level="3.2" data-chapter-title="Basic Test Example" data-filepath="blocks/test.md" data-basepath=".." data-revision="Thu Jul 20 2017 18:38:06 GMT-0700 (PDT)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="introduction/index.html">
            
                
                    <a href="../introduction/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Introduction
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="introduction/getting-started.html">
            
                
                    <a href="../introduction/getting-started.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Getting Started
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="introduction/basic-example.html">
            
                
                    <a href="../introduction/basic-example.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Examples
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="introduction/background.html">
            
                
                    <a href="../introduction/background.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Background
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="architecture/index.html">
            
                
                    <a href="../architecture/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Hardware Architecture
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="architecture/stage.html">
            
                
                    <a href="../architecture/stage.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Neural Stage
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="architecture/feedforward.html">
            
                
                    <a href="../architecture/feedforward.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.1.</b>
                        
                        Feedforward
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="architecture/update.html">
            
                
                    <a href="../architecture/update.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.2.</b>
                        
                        Tap Update
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="architecture/backpropagate.html">
            
                
                    <a href="../architecture/backpropagate.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.3.</b>
                        
                        Error Back Propagation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="architecture/memory.html">
            
                
                    <a href="../architecture/memory.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.4.</b>
                        
                        Memory Layout
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="architecture/future.html">
            
                
                    <a href="../architecture/future.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Future Directions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="blocks/index.html">
            
                
                    <a href="../blocks/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Building Blocks
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="blocks/simple.html">
            
                
                    <a href="../blocks/simple.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Basic Block Example
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="3.2" data-path="blocks/test.html">
            
                
                    <a href="../blocks/test.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Basic Test Example
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="blocks/Neuron.html">
            
                
                    <a href="../blocks/Neuron.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Neuron
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="blocks/Sigmoid.html">
            
                
                    <a href="../blocks/Sigmoid.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Sigmoid
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="blocks/NeuralStage.html">
            
                
                    <a href="../blocks/NeuralStage.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Neural Stage
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="dsl/index.html">
            
                
                    <a href="../dsl/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Tool Usage
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="language/index.html">
            
                
                    <a href="../language/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Language Description
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >NeuralHDL</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="basic-test-description">Basic Test Description</h1>
<p>A basic test bench is shown below. There is automatic signal connections in this tool so the creation of a test bench simply requires instantiating the module and connecting the signals with stimulus. Explanations of simple operations can be seen in the code below. This is a simple test bench but there are more complicated options available. </p>
<p>This test bench is shown due to it&apos;s simplicity but the normal test strategy has changed a bit with new blocks. Numpy is far better than scala in terms of math so the plan going forward is to more matching/analysis operations to python. There was an initial desire to stay within a single language but in the end the choice was made to use the correct tools for the job.  </p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NeuronTest</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span></span> <span class="hljs-title">BlockScalaTest</span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-title">BlockTestParser</span>  {</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">blockName</span>:</span><span class="hljs-type">String</span> = <span class="hljs-string">&quot;neuron&quot;</span>

  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">dutParser</span> =</span> <span class="hljs-keyword">new</span> <span class="hljs-type">NeuronTest</span>.<span class="hljs-type">Dut</span>(blockName)
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">dut</span>:</span> <span class="hljs-type">NewEntity</span> = dutParser.createEntity

  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">delayIndex</span> =</span> signal(<span class="hljs-type">SignalTrait</span>(<span class="hljs-string">&quot;d_index&quot;</span>,<span class="hljs-type">WIRE</span>,<span class="hljs-type">U</span>(<span class="hljs-number">31</span>,<span class="hljs-number">0</span>)))

  <span class="hljs-comment">// Creation of Random Stimulus for block</span>
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">data</span> =</span> <span class="hljs-type">DataFileGenerator</span>.createData(<span class="hljs-type">Array</span>(testLength,<span class="hljs-number">1</span>),s<span class="hljs-string">&quot;$dataLocation/data&quot;</span>,<span class="hljs-type">DataFileGenerator</span>.<span class="hljs-type">RANDOM</span>)
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">tap</span>  =</span> <span class="hljs-type">DataFileGenerator</span>.createData(<span class="hljs-type">Array</span>(testLength,<span class="hljs-number">1</span>),s<span class="hljs-string">&quot;$dataLocation/tap&quot;</span>,<span class="hljs-type">DataFileGenerator</span>.<span class="hljs-type">RANDOM</span>)
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">bias</span> =</span> <span class="hljs-type">DataFileGenerator</span>.createData(<span class="hljs-type">Array</span>(testLength,<span class="hljs-number">1</span>),s<span class="hljs-string">&quot;$dataLocation/bias&quot;</span>,<span class="hljs-type">DataFileGenerator</span>.<span class="hljs-type">RANDOM</span>)

  <span class="hljs-comment">// Output results to match against</span>
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">result</span> =</span> ((tap.data*data.data).d(<span class="hljs-number">1</span>) + bias.data.a(<span class="hljs-number">1</span>)).d(<span class="hljs-number">1</span>)
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">out</span>  =</span> <span class="hljs-type">DataFileGenerator</span>.createFlatten(s<span class="hljs-string">&quot;$dataLocation/out&quot;</span>,result)

  /- (<span class="hljs-string">&quot;Delay the bias to line up the data&quot;</span>)
  delayIndex := index - <span class="hljs-number">1</span>;

  <span class="hljs-comment">// Drive the design signals with the created data</span>
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">dataInD</span>   =</span> dutParser.dataIn &lt;-- data
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">tapInD</span>    =</span> dutParser.tapIn  &lt;-- tap
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">biasInD</span>   =</span> dutParser.biasIn &lt;-- bias

  <span class="hljs-comment">// Dump the signal to a file. </span>
  <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">rout</span> =</span> dutParser.dataOut ---&gt; (s<span class="hljs-string">&quot;$dataLocation/rout&quot;</span>, <span class="hljs-type">Some</span>(out), <span class="hljs-string">&quot;Neuron Output&quot;</span>)

  <span class="hljs-comment">// Operations to check post run</span>
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">postRun</span> =</span> {
    <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">output</span> =</span> rout.load()
    <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">error</span> =</span> <span class="hljs-type">PlotUtility</span>.plotError(output.data().asDouble(),
      result.data().asDouble(),<span class="hljs-type">Some</span>(s<span class="hljs-string">&quot;$docLocation/results&quot;</span>))
    assert(error.max._1 &lt; <span class="hljs-number">.05</span>)
  }





}
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../blocks/simple.html" class="navigation navigation-prev " aria-label="Previous page: Basic Block Example"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../blocks/Neuron.html" class="navigation navigation-next " aria-label="Next page: Neuron"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-mermaid-2/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"mermaid-2":{"theme":"forest"},"katex":{},"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
