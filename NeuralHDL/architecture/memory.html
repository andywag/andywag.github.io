<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Memory Layout | NeuralHDL</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-mermaid-2/bower_components/mermaid/dist/mermaid.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../architecture/future.html" />
    
    
    <link rel="prev" href="../architecture/backpropagate.html" />
    

        <script src="../gitbook/plugins/gitbook-plugin-mermaid-2/bower_components/mermaid/dist/mermaid.min.js"></script><link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-mermaid-2/bower_components/mermaid/dist/mermaid.forest.css"></link>
    </head>
    <body>
        
        
    <div class="book" data-level="3.1.4" data-chapter-title="Memory Layout" data-filepath="architecture/memory.md" data-basepath=".." data-revision="Wed Jul 12 2017 06:57:26 GMT-0700 (PDT)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="introduction/index.html">
            
                
                    <a href="../introduction/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Introduction
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="introduction/getting-started.html">
            
                
                    <a href="../introduction/getting-started.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Getting Started
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="introduction/basic-example.html">
            
                
                    <a href="../introduction/basic-example.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Examples
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="introduction/background.html">
            
                
                    <a href="../introduction/background.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Background
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="dsl/index.html">
            
                
                    <a href="../dsl/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Tool Usage
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="architecture/index.html">
            
                
                    <a href="../architecture/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Hardware Architecture
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="architecture/stage.html">
            
                
                    <a href="../architecture/stage.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Neural Stage
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="architecture/feedforward.html">
            
                
                    <a href="../architecture/feedforward.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.1.</b>
                        
                        Feedforward
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="architecture/update.html">
            
                
                    <a href="../architecture/update.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.2.</b>
                        
                        Tap Update
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="architecture/backpropagate.html">
            
                
                    <a href="../architecture/backpropagate.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.3.</b>
                        
                        Error Back Propagation
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="3.1.4" data-path="architecture/memory.html">
            
                
                    <a href="../architecture/memory.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.4.</b>
                        
                        Memory Layout
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="architecture/future.html">
            
                
                    <a href="../architecture/future.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Future Directions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="blocks/index.html">
            
                
                    <a href="../blocks/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Building Blocks
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="blocks/Neuron.html">
            
                
                    <a href="../blocks/Neuron.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Neuron
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="blocks/Sigmoid.html">
            
                
                    <a href="../blocks/Sigmoid.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Sigmoid
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="blocks/NeuralStage.html">
            
                
                    <a href="../blocks/NeuralStage.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Neural Stage
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="language/index.html">
            
                
                    <a href="../language/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Language Description
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >NeuralHDL</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="memory-layout">Memory Layout</h1>
<p>The memory for each stage is split into 3 separate memories based on their size and frequency of use. Different memory architectures can be selected depending on the frequency of use and properites of the memories. This architecture assumes a memory running at the same rate as the neural stage and a dual port memory.</p>
<ol>
<li>Data Memory</li>
<li>Bias Memory</li>
<li>Tap and Error Memory</li>
</ol>
<p>The memory size of the model is fixed based on the size of the network, but the depths for the data and error require careful consideration to keep the network fully utilized. The main constraint for the network is the input data and error must be available at the same time to properly update the taps. This requires the data to be stored inside the block until the error is available or will halt the operations. </p>
<h2 id="data-memory">Data Memory</h2>
<p>The data memory contains the input data to the stage. This information is required for both the feedforward operation of the stage and the error updates. </p>
<ol>
<li>The memory read requires one data sample per stage calculation. </li>
<li>The depth of the memory is a function of the maximum error feedback time and throughput requirements</li>
</ol>
<table>
<thead>
<tr>
<th>Address</th>
<th style="text-align:center">Data</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td style="text-align:center">Data0</td>
</tr>
<tr>
<td>1</td>
<td style="text-align:center">Data1</td>
</tr>
<tr>
<td>K</td>
<td style="text-align:center">DataK</td>
</tr>
<tr>
<td>K+1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>...</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>N</td>
<td style="text-align:center">Data(K+1)</td>
</tr>
<tr>
<td>...</td>
<td style="text-align:center">...</td>
</tr>
</tbody>
</table>
<p>The current memory is stored inefficiently using the mapping above where </p>
<ul>
<li>K is the length of the input data vector</li>
<li>N is ceil(log2(K))</li>
</ul>
<p><code>This mapping is innefficient but greatly eases both the addressing design as well as the debugging. This is used as a prototyping test and will be left as a mode for debug as well.</code></p>
<h2 id="bias-memory">Bias Memory</h2>
<p>The bias memory contains the bias values from the network. </p>
<ol>
<li>The memory read requires one data sample per stage calculation. </li>
<li>The depth of this memory is equivalent to the amount of neurons in the stage</li>
</ol>
<p>The use of the bias term occurs at a later time than the data operation so there is the potential to delay the data with the read and write addresses. The effectiveness of this is limited somewhat by the bias update and bias use having different pipeline delays. </p>
<h2 id="tap-and-error-memory">Tap and Error Memory</h2>
<p>This is a parallel memory which has an output width which is a multiple of the number of MAC units used in the stage. The tap memory contains both the tap values for the stage as well as the error which simplifies the interface to the stage and reduces the memory requirements. </p>
<ol>
<li>The memory requires one parallel read (number of neurons width) for each operation of the neural stage</li>
<li>The depth of the memory is equivalent to the size of the taps plus the required error storage. </li>
</ol>
<p>The memory is assumed to have read/write access to individaul taps as well as the full set of parallel taps. This is used for </p>
<table>
<thead>
<tr>
<th>Address</th>
<th style="text-align:center">Memory0</th>
<th>Memory 1</th>
<th style="text-align:center">...</th>
<th style="text-align:right">Memory K</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td style="text-align:center">H(0,0)</td>
<td>H(0,1)</td>
<td style="text-align:center">...</td>
<td style="text-align:right">H(0,K)</td>
</tr>
<tr>
<td>1</td>
<td style="text-align:center">H(1,0)</td>
<td>H(1,1)</td>
<td style="text-align:center">...</td>
<td style="text-align:right">H(1,K)</td>
</tr>
<tr>
<td>2</td>
<td style="text-align:center">H(2,0)</td>
<td>H(2,1)</td>
<td style="text-align:center">...</td>
<td style="text-align:right">H(2,K)</td>
</tr>
<tr>
<td>K</td>
<td style="text-align:center">H(K,0)</td>
<td>H(K,1)</td>
<td style="text-align:center">...</td>
<td style="text-align:right">H(K,K)</td>
</tr>
<tr>
<td>K+1</td>
<td style="text-align:center">E(0,0)</td>
<td>E(0,1)</td>
<td style="text-align:center">...</td>
<td style="text-align:right">E(0,K)</td>
</tr>
<tr>
<td>K+2</td>
<td style="text-align:center">E(1,0)</td>
<td>E(1,1)</td>
<td style="text-align:center">...</td>
<td style="text-align:right">E(1,K)</td>
</tr>
<tr>
<td>...</td>
<td style="text-align:center">...</td>
<td>...</td>
<td style="text-align:center">...</td>
<td style="text-align:right">...</td>
</tr>
</tbody>
</table>
<p>The contents of the tap and error memory is shown above. The memory contains a reshaped version of the taps with the row width equal to the number of neurons. </p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../architecture/backpropagate.html" class="navigation navigation-prev " aria-label="Previous page: Error Back Propagation"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../architecture/future.html" class="navigation navigation-next " aria-label="Next page: Future Directions"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-mermaid-2/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"mermaid-2":{"theme":"forest"},"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
